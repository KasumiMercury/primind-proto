syntax = "proto3";

package auth.v1;

option go_package = "gen/auth/v1;authv1";

service AuthService {
  rpc OIDCParams(OIDCParamsRequest) returns (OIDCParamsResponse);
  rpc OIDCLogin(OIDCLoginRequest) returns (OIDCLoginResponse);
  rpc Logout(LogoutRequest) returns (LogoutResponse);
  rpc ValidateSession(ValidateSessionRequest) returns (ValidateSessionResponse);
}

// OIDCProvider represents an external OpenID Connect identity provider.
enum OIDCProvider {
  // OIDC_PROVIDER_UNSPECIFIED should not be used.
  OIDC_PROVIDER_UNSPECIFIED = 0;

  // Google as an OIDC provider.
  OIDC_PROVIDER_GOOGLE = 1;
}

message OIDCParamsRequest {
  OIDCProvider provider = 1;
  string client_id = 2;
}

message OIDCParamsResponse {
  string authorization_url = 1;
  string state = 2;
}

message OIDCLoginRequest {
  OIDCProvider provider = 1;
  string code = 2;
  string state = 3;
}

message OIDCLoginResponse {
  string session_token = 1;
}

message LogoutRequest {
  string session_token = 1;
}

message LogoutResponse {
  bool success = 1;
}

message ValidateSessionRequest {
  string session_token = 1;
}

message ValidateSessionResponse {
  string user_id = 1;
}
